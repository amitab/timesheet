{% include 'head.html' %}

    <div class="row">
        <div class="six columns centered card">
            <div class="timer">
                <div class="flip-counter clock">
                    <div class="duration">
                        <div class="inn" id="hour">00</div>
                    </div>
                    <div class="duration">
                        <div class="inn" id="minute">00</div>
                    </div>
                </div>
            </div>
            <section class="timer">
                <div class="title" style="text-align:center;"><h4>Project a</h4></div>
                <p class="about">Application Widget Development</p>
                <p class="instruction">Click <span>Start</span> to start working on this project 
                or <span>Add</span> to add an old Timesheet from top.</p>
                <div class="start-button-container" style="margin-top: 1rem;">
                    <div class="medium warning btn disabled">
                        <a href="http://www.google.com" id="pause-button">Pause</a>
                    </div>
                    <div class="medium secondary btn">
                        <a href="#" id="start-button" class="stopped">Start</a>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <script>
        $(document).ready(function(){
            
            var startTime = null;
            var endTime = null;
            var interval;
            
            // in seconds
            var pauseTime = 0;
            var workTime = 0;
            
            function minuteUp() {
                var minute = parseInt($('#minute').text());
                var res;
                if(minute >= 59) hourUp();
                minute = (minute + 1) % 60;
                if(minute < 10) {
                    res = '0' + minute
                } else res = minute;
                $('#minute').text(res);
            }
            
            function hourUp() {
                var hour = parseInt($('#hour').text());
                var res;
                hour++;
                if(hour < 10) {
                    res = '0' + hour
                } else res = hour;
                $('#hour').text(res)
            }
            
            function logger(x) {
                console.log(x);
            }
            
            function startClock() {
                if(startTime == null) {
                    startTime = new Date(Date.now());
                    logger(startTime);
                }
                interval = setInterval(function(){
                    workTime = (workTime+1) % 60;
                    if(workTime == 0)
                        minuteUp();
                }, 1000);
            }
            
            function setStopDate() {
                if(endTime == null) {
                    endTime = new Date(Date.now());
                    logger(endTime);
                }
            }
            
            function resultTime() {
                var elapsed = (endTime.getTime() - startTime.getTime()) / 1000; 
                var pauseTime = Math.floor(elapsed - workTime);
                logger('Elapsed : ' + elapsed);
                logger('Work Time : ' + workTime);
                logger('Pause Time : ' + pauseTime);
            }
            
            function stopClock() {
                clearInterval(interval);
            }
            
            $('#start-button').click(function(e) {
                if($(this).hasClass('stopped')) {
                    startClock();
                    $(this).removeClass('stopped').addClass('started');
                    $(this).parent().removeClass('secondary').addClass('danger');
                    $(this).text("Stop");
                    $('#pause-button').parent().removeClass('disabled');
                } else if($(this).hasClass('started')) {
                    setStopDate();
                    resultTime();
                    stopClock();
                    $(this).removeClass('started').addClass('stopped');
                    $(this).parent().removeClass('danger').addClass('secondary');
                    $(this).text("Start");
                    $('#pause-button').parent().addClass('disabled');
                    
                    $('#pause-button').text("Pause");
                    $('#pause-button').parent().addClass('warning');
                    $('#pause-button').removeClass('paused primary');
                }
                e.preventDefault();
            });
            
            $('#pause-button').click(function(e) {
                if($(this).parent().hasClass('disabled')) {
                    e.preventDefault();
                    return false;
                }
                if(!$(this).hasClass('paused')) {
                    stopClock();
                    $(this).text("Resume");
                    $(this).parent().removeClass('warning');
                    $(this).parent().addClass('primary');
                    $(this).addClass('paused');
                } else {
                    startClock();
                    $(this).text("Pause");
                    $(this).parent().addClass('warning');
                    $(this).parent().removeClass('primary');
                    $(this).removeClass('paused');
                }
            });
            
        });
    </script>

{% include 'foot.html' %}